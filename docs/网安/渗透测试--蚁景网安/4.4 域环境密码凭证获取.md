
## Windows 域认证

### Kerberos协议
基于密钥的网络认证协议, 其目标是通过密钥系统位客户机/服务器应用程序提供认证服务
- 不依赖于主机操作系统的认证
- 无需基于主机地址的信任
- 不要求网络上所有主机的物理安全
- 假定网络上传送的数据包可以任意地被读取, 修改和插入

角色
- Client
- Server
- KDC: Key Distribution Center 密钥分发中心, 可信第三方

#### Ticket
- Ticket-Granting Ticket (TGT): 用来生成Ticket的Ticket, 由身份认证服务授予的票据(黄金票据), 存储于内存, 10分钟
- Service Ticket: 用于验证用户或服务身份的加密信息, 允许持有者访问特定资源

#### AD: Account Database
域中SAM数据库, KDC可以完全访问

#### KDC: Key Distribution Center
= Domain Controller
- Authentication Server (AS): 身份认证, 为client生成TGT
- Ticket-Granting Server (TGS): 票据授予, 对指定client和服务生成ticket

#### 安全密钥
加密和验证会话密钥
client密钥, TGS密钥和service 密钥均为对应用户的NTLM Hash

#### 会话密钥 Session Key
加密客户端与服务端通信的密钥