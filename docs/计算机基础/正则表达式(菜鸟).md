# 正则表达式
正则表达式（regular expression）描述了一种字符串匹配的模式（pattern），可以用来检查一个串是否 含有某种子串、将匹配的子串替换 或从某个穿中取出符合某个条件的子串等

## 元字符
**使用\\将下一个字符标记为或特殊字符, 或原义字符, 或向后引用, 或八进制转义符, 特殊字符取消转义**

### 特殊字符: 
- ^ 匹配输入字符串的开始位置, 如果设置了RegExp对象的Multiline, 则也匹配'\n'和'\r'之后的位置, **在方括号的开头使用表示'非'**
- $ 匹配输入字符串的结尾位置, 如果设置了RegExp对象的Multiline, 则也匹配'\n'和'\r'之前的位置
- () 一个子表达式开始和结束的位置
- ? 限定符, 匹配前面的子表达式零次或一次, 或指明一个非贪婪限定符
- +限定符, 匹配前面的子表达式一次或多次(贪婪)
- \*限定符, 匹配前面的子表达式零次, 一次或多次(贪婪)
- . 匹配除换行符\n和\r以外的所有字符，相当于\[^\n\r]
- [] 中括号表达式, 分别匹配括号内的多个元素, 元素可以是任意字符/范围/子表达式并可以堆叠
	- 0-9 区间内的数字
	- a-z 区间内的字母，大小写敏感
- {} 标记限定符表达式的开始和结束
- | 或

### 非打印字符:
- \f  换页符, 等同\x0c 和 \cL
- \n 换行符, 等同\x0a 和\cJ
- \r  回车符, 等同\x0d和\cM
- \t  制表符, 等同\x09 和\cI
- \v 垂直制表符, 等同\x0b 和\cK
- \s 任何空白字符, 等同[ \f\n\r\t\v], 包括空格
- \S 任何非空白字符, 等同\[^ \f\n\r\t\v], 不包括空格
- \d 匹配一个数字字符, 等同[0-9]
- \D 匹配一个非数字字符, 等同\[^0-9]
- \w 匹配数字, 字母, 下划线，等同[A-Za-z0-9_]
- \W 匹配非数字, 字母, 下划线, 等同\[^A-Za-z0-9_]
- \cn 匹配n 控制字符，如\cM匹配一个Ctrl-M或回车符，其中x必须为[A-Za-z], 否则判定为'c'原义字符
- \xn 匹配n 十六进制转义值, 该值必须为确定的两个十六进制长度
	- 转义值对应ASCII(0-255)
- \n 匹配n 如果n小于其之前获取的表达式数量, 则n为向后引用; 否则如果n为八进制数字(0-7), 则n为一个八进制转义值
- \nm 匹配nm 如果nm之前至少有nm个获得子表达式, 则nm为向后引用; 如果其之前至少有n个获取, 则n为一个后跟文字m的向后引用; 如果前面的条件都不满足, 若n和m均为八进制数字(0-7), 则匹配八进制转义值nm
- \nml 匹配nml 如果n为八进制数字(0-3), 且m和l均为八进制数字(0-7), 则匹配八进制转义值nml
- \un 匹配n 其中n为一个用四位十六进制数字表示的Unicode字符

### 限定符: 
**其中'?' '+' '\*'同时属于特殊字符**
- {n} n是一个非负整数, 匹配确定的n次
- {n,} 至少匹配n次
- {n,m} 匹配n至m次(n<=m), 包括n次和m次
- 在限定符+ * ?后面放置?, 该表达式转换为"非贪婪"表达式或最小匹配

### 定位符: 
**限定符与定位符不能一起使用**
- ^ 和$匹配字符串的开始和结尾位置
- \b 匹配一个单词边界, 即字与空格之间的位置
- \B 匹配非单词边界, 除单词与空格之间的其他位置

## 选择: 
- 用()将所有选择项括起来, 之间用'|'分隔, 表示或逻辑的连接
- () 表示捕获分组, 可以将匹配的值保存至变量, 按照在pattern中从左到右出现的顺序,多个匹配值可以通过num来引用, 在表达式中应添加'\', 其中num为一个正整数
- 圆括号()会导致相关的匹配被缓存, 可以在捕获的分组中使用*非捕获元字符*辅助查找 ?: ?= ?!

### 先行断言(lookahead) 和后行断言(lookbehind):
- "零宽"指其在匹配过程中不占用字符, 只匹配某些位置
- "位置"为在字符串中(每行)所有相邻相邻字符的中间, 以及第一个字符之前, 最后一个字符之后
- (?=pattern) (零宽)正向先行断言zero-width-positive-lookahead-assertion
	匹配字符串中的一个位置, 紧接该位置之后的字符序列匹配pattern
- (?!pattern)  零宽负向先行断言zero-width-negative-lookahead-assertion
	匹配字符串中的一个位置, 紧接该位置之后的字符序列不匹配pattern(不等于)
- (?<=pattern)零宽正向后行断言zero-width-positive-lookbehind-assertion
	匹配字符串中的一个位置, 相邻该位置之前的字符序列匹配pattern
- (?<!pattern)零宽负向后行断言zero-width-negative-lookbehind-assertion
	匹配字符串中的一个位置, 相邻该位置之前的字符序列不匹配pattern(不等于)
***在Perl和Python中, 对于两种后行断言, 其表达式必须是定长(fixed length), 即不能使用限定符等元字符***

### 反向引用(向后引用):
- 对一个正则表达式模式或部分模式两边添加圆括号()导致相关匹配存储到一个临时缓冲区中, 所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储
- 缓冲区编号从1开始, 最多可存储99个捕获的子表达式(0一般为原字符串)
- 每个缓冲区都可以使用\n来访问, 其中n为该缓冲区的编号(一位或两位十进制数)
- 可以使用非捕获元字符?: ?= ?! 来重写捕获, 忽略对相关匹配的保存
- 基本用法:
	- 用作查找文本中两个相同的相邻单词的匹配项 /\b([a-z]+) \1\b/ig
	- 用作将URL分解为其组件 /(\w+):\/\/(\[^/:]+)(:\d\*)?(\[^# ]*)/

## 标记修饰符(flags)
**/pattern/flags**
- i ignore-不区分大小写
- g global-全局匹配: 查找所有的匹配项
- m multi line-多行匹配: 使边界字符'^'和'$'匹配每一行的开头和结尾(对于'\n')
- s 特殊字符'.'(表示除'\n'以外的任何字符)中包含换行符'\n'
***gm可以配合使用***

## 运算符优先级
相同优先级的从左到右进行运算, 不同优先级的运算先高后低
优先级(从高到低)
- 转义符('\')
- 圆括号和方括号
- 限定符
- 定位点和序列, 即位置和顺序(^, $, 任何元字符, 任何字符)
- 替换, 也称为"或"操作("|"), 任何字符都具有高于替换运算符的优先级

## 匹配规则
### 基本模式匹配
模式是正则表达式最基本的元素, 它们是一组描述字符串特征的字符. 往往用特殊的字符表示一个范围内的字符/重复/上下文(^$等)

### 子模式捕获
- `(regexpr)`: 创建一个捕获子模式
- `(?<name>regexpr)`: 命名捕获子模式
- `(?:regexpr)`: 非捕获子模式
- `\N, \gN, \g{N}`: 对捕获子模式N的**反向引用**
	- `N`: 一个自然数, 代表前面使用的第N个子模式 
	- `g`: global
- `\g{name}`: 对命名捕获子模式的**反向引用**

### 字符簇
在网络应用程序中, 正则表达式通常用来验证用户的输入. 使用字符簇来更自由地描述需求的模式(中括号标识符[])
#### PHP内置通用字符簇 \[[:xxxxx:]]
- alpha 字母
- digit 数字
- alnum 字母和数字
- space 空白字符
- upper 大写字母
- lower 小写字母
- punct 标点符号
- xdigit 任何16进制的数字, 相当于[0-9a-fA-F]